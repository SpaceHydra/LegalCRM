<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Empaneled Advocates - Legal CRM</title>
    <link rel="stylesheet" href="css/common-styles.css">
    <style>
        /* Advocates specific styles */
        .advocates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .advocate-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border-left: 4px solid #3498db;
        }

        .advocate-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .advocate-card.busy {
            border-left-color: #f39c12;
        }

        .advocate-card.on-leave {
            border-left-color: #e74c3c;
            opacity: 0.7;
        }

        .advocate-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .advocate-info h3 {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .advocate-info p {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 3px;
        }

        .availability-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .availability-badge.available {
            background: #d4edda;
            color: #27ae60;
        }

        .availability-badge.busy {
            background: #fff3cd;
            color: #f39c12;
        }

        .availability-badge.on-leave {
            background: #f8d7da;
            color: #e74c3c;
        }

        .advocate-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
            padding: 15px 0;
            border-top: 1px solid #ecf0f1;
            border-bottom: 1px solid #ecf0f1;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            display: block;
        }

        .stat-label {
            font-size: 11px;
            color: #7f8c8d;
            text-transform: uppercase;
            margin-top: 3px;
        }

        .rating-stars {
            color: #f39c12;
            font-size: 14px;
            margin: 5px 0;
        }

        .specialization-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }

        .spec-tag {
            background: #e3f2fd;
            color: #2196f3;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .advocate-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .advocate-actions button {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .btn-assign {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-view {
            background: #ecf0f1;
            color: #2c3e50;
        }

        .btn-assign:hover {
            transform: scale(1.05);
        }

        .btn-view:hover {
            background: #d5dbdb;
        }

        /* Filter Section */
        .filters-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-item label {
            display: block;
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .filter-item select,
        .filter-item input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            margin: 20px;
        }

        .modal-header {
            padding: 25px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 22px;
            color: #2c3e50;
        }

        .close-btn {
            font-size: 28px;
            cursor: pointer;
            color: #7f8c8d;
        }

        .close-btn:hover {
            color: #2c3e50;
        }

        .modal-body {
            padding: 25px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            color: #2c3e50;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid #ecf0f1;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #95a5a6;
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Top Navigation Bar -->
    <div class="top-nav">
        <div class="logo-section">
            <div class="logo">LC</div>
            <div class="system-title">
                <h1>Legal CRM Portal</h1>
                <p>SNG & Partners - Business Development Platform</p>
            </div>
        </div>
        <div class="user-section">
            <div class="search-box">
                <span>üîç</span>
                <input type="text" placeholder="Search advocates...">
            </div>
            <div class="notification-icon">
                <span style="font-size: 24px;">üîî</span>
                <div class="badge" id="notificationCount">0</div>
            </div>
            <div class="user-profile">
                <div class="user-avatar">PM</div>
                <div>
                    <div style="font-weight: 600; font-size: 14px;">Prateek Mehta</div>
                    <div style="font-size: 11px; opacity: 0.8;">Senior Advocate</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="nav-section">
            <div class="nav-section-title">Core Modules (MVP)</div>
            <a href="dashboard.html" class="nav-item">
                <div class="nav-icon">üìä</div>
                <div class="nav-label">Dashboard</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="lead-management.html" class="nav-item">
                <div class="nav-icon">üéØ</div>
                <div class="nav-label">Lead Management</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="client-management.html" class="nav-item">
                <div class="nav-icon">üë•</div>
                <div class="nav-label">Client Management</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="project-management.html" class="nav-item">
                <div class="nav-icon">üìÅ</div>
                <div class="nav-label">Matter/Project Management</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="task-management.html" class="nav-item">
                <div class="nav-icon">‚úÖ</div>
                <div class="nav-label">Task Management</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="document-management.html" class="nav-item">
                <div class="nav-icon">üìÑ</div>
                <div class="nav-label">Document Management</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="user-management.html" class="nav-item">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">User & Role Management</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="reporting.html" class="nav-item">
                <div class="nav-icon">üìà</div>
                <div class="nav-label">Basic Reporting</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="billing.html" class="nav-item">
                <div class="nav-icon">üí∞</div>
                <div class="nav-label">Billing & Revenue</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
            <a href="calendar.html" class="nav-item">
                <div class="nav-icon">üìÜ</div>
                <div class="nav-label">Calendar Integration</div>
                <div class="phase-badge mvp">MVP</div>
            </a>
        </div>

        <div class="nav-section">
            <div class="nav-section-title">Phase 2</div>
            <a href="advocates-management.html" class="nav-item active">
                <div class="nav-icon">üë®‚Äç‚öñÔ∏è</div>
                <div class="nav-label">Empaneled Advocates</div>
                <div class="phase-badge phase2">Phase 2</div>
            </a>
            <a href="audit-trail.html" class="nav-item">
                <div class="nav-icon">üîç</div>
                <div class="nav-label">Audit Trail</div>
                <div class="phase-badge phase2">Phase 2</div>
            </a>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h2>Empaneled Advocates</h2>
            <button class="btn-add" onclick="window.location.href='add-advocate.html'">
                <span style="font-size: 18px;">‚ûï</span> Add New Advocate
            </button>
        </div>

        <!-- Filters Section -->
        <div class="filters-section">
            <div class="filters-grid">
                <div class="filter-item">
                    <label>Availability Status</label>
                    <select id="filterAvailability" onchange="loadAdvocates()">
                        <option value="">All Statuses</option>
                        <option value="Available">Available</option>
                        <option value="Busy">Busy</option>
                        <option value="On Leave">On Leave</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>Specialization</label>
                    <select id="filterSpecialization" onchange="loadAdvocates()">
                        <option value="">All Specializations</option>
                        <option value="Corporate Law">Corporate Law</option>
                        <option value="Criminal Law">Criminal Law</option>
                        <option value="Real Estate">Real Estate Law</option>
                        <option value="Banking">Banking Law</option>
                        <option value="Family Law">Family Law</option>
                        <option value="Intellectual Property">Intellectual Property</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>Location</label>
                    <select id="filterLocation" onchange="loadAdvocates()">
                        <option value="">All Locations</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Mumbai">Mumbai</option>
                        <option value="Bengaluru">Bengaluru</option>
                        <option value="Noida">Noida</option>
                        <option value="Jaipur">Jaipur</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>Search by Name</label>
                    <input type="text" id="searchAdvocate" placeholder="Search advocate..." onkeyup="loadAdvocates()">
                </div>
            </div>
        </div>

        <!-- Advocates Grid -->
        <div id="advocatesContainer" class="advocates-grid">
            <!-- Dynamic content loaded here -->
        </div>
    </div>

    <!-- Add/Edit Advocate Modal -->
    <div class="modal" id="advocateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Advocate</h2>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="advocateForm">
                    <input type="hidden" id="advocateId">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" id="advocateName" required placeholder="Advocate Name">
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="advocateEmail" required placeholder="email@example.com">
                        </div>
                        <div class="form-group">
                            <label>Phone *</label>
                            <input type="tel" id="advocatePhone" required placeholder="+91-XXXXX-XXXXX">
                        </div>
                        <div class="form-group">
                            <label>Bar Council Number *</label>
                            <input type="text" id="barCouncilNo" required placeholder="D/1234/2008">
                        </div>
                        <div class="form-group">
                            <label>Enrollment Year *</label>
                            <input type="text" id="enrollmentYear" required placeholder="2008">
                        </div>
                        <div class="form-group">
                            <label>Experience (Years) *</label>
                            <input type="number" id="experienceYears" required placeholder="10">
                        </div>
                        <div class="form-group">
                            <label>City *</label>
                            <input type="text" id="advocateCity" required placeholder="Mumbai">
                        </div>
                        <div class="form-group">
                            <label>State *</label>
                            <input type="text" id="advocateState" required placeholder="Maharashtra">
                        </div>
                        <div class="form-group">
                            <label>Hourly Rate (‚Çπ)</label>
                            <input type="number" id="hourlyRate" placeholder="8000">
                        </div>
                        <div class="form-group">
                            <label>Retainer Rate (‚Çπ)</label>
                            <input type="number" id="retainerRate" placeholder="150000">
                        </div>
                        <div class="form-group">
                            <label>Availability Status *</label>
                            <select id="availabilityStatus" required>
                                <option value="Available">Available</option>
                                <option value="Busy">Busy</option>
                                <option value="On Leave">On Leave</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>PAN Number</label>
                            <input type="text" id="panNumber" placeholder="ABCDE1234F">
                        </div>
                        <div class="form-group full-width">
                            <label>Specialization (comma separated) *</label>
                            <input type="text" id="specialization" required placeholder="Corporate Law, Mergers & Acquisitions">
                        </div>
                        <div class="form-group full-width">
                            <label>Qualifications (comma separated)</label>
                            <input type="text" id="qualifications" placeholder="B.A. LL.B, LL.M - Corporate Law">
                        </div>
                        <div class="form-group full-width">
                            <label>Courts of Practice (comma separated)</label>
                            <input type="text" id="courtsOfPractice" placeholder="Supreme Court, Delhi High Court">
                        </div>
                        <div class="form-group full-width">
                            <label>Notes</label>
                            <textarea id="advocateNotes" placeholder="Additional notes about the advocate..."></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveAdvocate()">Save Advocate</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/data.js"></script>
    <script src="js/common.js"></script>
    <script>
        // Load advocates on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadAdvocates();
        });

        function loadAdvocates() {
            const advocates = legalCRM.get('advocates');

            // Get filter values
            const filterAvailability = document.getElementById('filterAvailability').value;
            const filterSpecialization = document.getElementById('filterSpecialization').value;
            const filterLocation = document.getElementById('filterLocation').value;
            const searchTerm = document.getElementById('searchAdvocate').value.toLowerCase();

            // Apply filters
            let filteredAdvocates = advocates.filter(adv => {
                const matchesAvailability = !filterAvailability || adv.availabilityStatus === filterAvailability;
                const matchesSpecialization = !filterSpecialization || adv.specialization.some(s => s.includes(filterSpecialization));
                const matchesLocation = !filterLocation || adv.city === filterLocation;
                const matchesSearch = !searchTerm || adv.name.toLowerCase().includes(searchTerm) ||
                                                    adv.email.toLowerCase().includes(searchTerm);

                return matchesAvailability && matchesSpecialization && matchesLocation && matchesSearch;
            });

            const container = document.getElementById('advocatesContainer');

            if (filteredAdvocates.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <h3>No Advocates Found</h3>
                        <p>No advocates match your search criteria</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredAdvocates.map(advocate => {
                const availabilityClass = advocate.availabilityStatus.toLowerCase().replace(/\s+/g, '-');
                const stars = '‚≠ê'.repeat(Math.floor(advocate.rating));
                const halfStar = advocate.rating % 1 >= 0.5 ? '¬Ω' : '';

                return `
                    <div class="advocate-card ${availabilityClass}">
                        <div class="advocate-header">
                            <div class="advocate-info">
                                <h3>${advocate.name}</h3>
                                <p>üìß ${advocate.email}</p>
                                <p>üì± ${advocate.phone}</p>
                                <p>üìç ${advocate.city}, ${advocate.state}</p>
                                <div class="rating-stars">${stars}${halfStar} ${advocate.rating}</div>
                            </div>
                            <span class="availability-badge ${availabilityClass}">${advocate.availabilityStatus}</span>
                        </div>

                        <div class="advocate-stats">
                            <div class="stat-item">
                                <span class="stat-value">${advocate.casesHandled}</span>
                                <span class="stat-label">Cases</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${advocate.successRate}%</span>
                                <span class="stat-label">Success</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${advocate.experienceYears}y</span>
                                <span class="stat-label">Experience</span>
                            </div>
                        </div>

                        <div class="specialization-tags">
                            ${advocate.specialization.slice(0, 3).map(spec =>
                                `<span class="spec-tag">${spec}</span>`
                            ).join('')}
                        </div>

                        <p style="font-size: 12px; color: #7f8c8d; margin-top: 10px;">
                            Active Assignments: <strong>${advocate.activeAssignments}</strong> |
                            Total Earnings: <strong>‚Çπ${advocate.totalEarnings.toLocaleString('en-IN')}</strong>
                        </p>

                        <div class="advocate-actions">
                            <button class="btn-assign" onclick="assignToCase('${advocate.id}')">Assign to Case</button>
                            <button class="btn-view" onclick="editAdvocate('${advocate.id}')">Edit Details</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function openAddAdvocateModal() {
            document.getElementById('modalTitle').textContent = 'Add New Advocate';
            document.getElementById('advocateForm').reset();
            document.getElementById('advocateId').value = '';
            document.getElementById('advocateModal').classList.add('active');
        }

        function editAdvocate(advocateId) {
            const advocate = legalCRM.getById('advocates', advocateId);
            if (!advocate) return;

            document.getElementById('modalTitle').textContent = 'Edit Advocate';
            document.getElementById('advocateId').value = advocate.id;
            document.getElementById('advocateName').value = advocate.name;
            document.getElementById('advocateEmail').value = advocate.email;
            document.getElementById('advocatePhone').value = advocate.phone;
            document.getElementById('barCouncilNo').value = advocate.barCouncilNo;
            document.getElementById('enrollmentYear').value = advocate.enrollmentYear;
            document.getElementById('experienceYears').value = advocate.experienceYears;
            document.getElementById('advocateCity').value = advocate.city;
            document.getElementById('advocateState').value = advocate.state;
            document.getElementById('hourlyRate').value = advocate.hourlyRate;
            document.getElementById('retainerRate').value = advocate.retainerRate;
            document.getElementById('availabilityStatus').value = advocate.availabilityStatus;
            document.getElementById('panNumber').value = advocate.panNumber;
            document.getElementById('specialization').value = advocate.specialization.join(', ');
            document.getElementById('qualifications').value = advocate.qualifications.join(', ');
            document.getElementById('courtsOfPractice').value = advocate.courtsOfPractice.join(', ');
            document.getElementById('advocateNotes').value = advocate.notes;

            document.getElementById('advocateModal').classList.add('active');
        }

        function saveAdvocate() {
            const advocateId = document.getElementById('advocateId').value;

            const advocateData = {
                name: document.getElementById('advocateName').value,
                email: document.getElementById('advocateEmail').value,
                phone: document.getElementById('advocatePhone').value,
                barCouncilNo: document.getElementById('barCouncilNo').value,
                enrollmentYear: document.getElementById('enrollmentYear').value,
                experienceYears: parseInt(document.getElementById('experienceYears').value),
                city: document.getElementById('advocateCity').value,
                state: document.getElementById('advocateState').value,
                location: document.getElementById('advocateCity').value,
                hourlyRate: parseInt(document.getElementById('hourlyRate').value) || 0,
                retainerRate: parseInt(document.getElementById('retainerRate').value) || 0,
                availabilityStatus: document.getElementById('availabilityStatus').value,
                panNumber: document.getElementById('panNumber').value,
                specialization: document.getElementById('specialization').value.split(',').map(s => s.trim()),
                qualifications: document.getElementById('qualifications').value.split(',').map(s => s.trim()),
                courtsOfPractice: document.getElementById('courtsOfPractice').value.split(',').map(s => s.trim()),
                notes: document.getElementById('advocateNotes').value
            };

            // Validation
            if (!advocateData.name || !advocateData.email || !advocateData.phone || !advocateData.barCouncilNo) {
                alert('Please fill all required fields');
                return;
            }

            if (advocateId) {
                // Update existing advocate
                legalCRM.update('advocates', advocateId, advocateData);
                alert('Advocate updated successfully!');
            } else {
                // Create new advocate
                const newAdvocate = {
                    id: legalCRM.generateId('advocates', 'ADV'),
                    ...advocateData,
                    rating: 4.0,
                    casesHandled: 0,
                    successRate: 0,
                    languagesKnown: ['English', 'Hindi'],
                    assignedCases: [],
                    activeAssignments: 0,
                    totalEarnings: 0,
                    empaneledDate: new Date().toISOString().split('T')[0],
                    status: 'Active',
                    documents: [],
                    bankAccountDetails: {
                        accountName: '',
                        accountNumber: '',
                        ifscCode: '',
                        bankName: '',
                        branch: ''
                    },
                    gstNumber: ''
                };
                legalCRM.create('advocates', newAdvocate);
                alert('Advocate added successfully!');
            }

            closeModal();
            loadAdvocates();
        }

        function assignToCase(advocateId) {
            const advocate = legalCRM.getById('advocates', advocateId);
            if (!advocate) return;

            alert(`Assignment feature coming soon!\n\nAdvocate: ${advocate.name}\nThis will allow assigning ${advocate.name} to specific cases/projects.`);
            // TODO: Implement case assignment functionality
        }

        function closeModal() {
            document.getElementById('advocateModal').classList.remove('active');
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('advocateModal');
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
